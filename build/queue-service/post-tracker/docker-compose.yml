version: '3.4'
services:

    post-tracker:
        image: node:9.9
        networks:
            - frontend
        volumes:
            - ./services:/usr/src/app
        environment:
            NODE_ENV: production
            LOG_LEVEL: ${LOG_LEVEL-info}
            PG_HOST: ${PG_HOST-postgres}
            PG_PORT: ${PG_PORT-5432}
            PG_USERNAME: ${PG_USERNAME-cerberus}
            PG_PASSWORD: ${PG_PASSWORD-cerberus}
            PG_DATABASE: ${PG_DATABASE-cerberus}
            PG_MAX_CONN_ATTEMPTS: ${PG_MAX_CONN_ATTEMPTS-10}
            PG_CONN_ATTEMPTS_DELAY: ${PG_CONN_ATTEMPTS_DELAY-10}
            PG_DEBUG: ${PG_DEBUG-off}
            AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY-xxx}
            AWS_ACCESS_KEY: ${AWS_ACCESS_KEY-xxx}
            AWS_REGION: ${AWS_REGION-xxx}
            AWS_BUCKET: ${AWS_BUCKET-xxx}
            AWS_ENABLE_BACKUP: ${AWS_ENABLE_BACKUP-yes}
        working_dir: /usr/src/app/post-tracker
        entrypoint: ["yarn", "start:prod"]

#
# Networks definition
#

networks:
    frontend:
